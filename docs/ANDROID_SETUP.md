# Android Setup & Google Play Store Guide

This guide covers how to set up your environment for Android development, generate production credentials, and submit to the Google Play Store.

## 1. Android Environment Setup (for local testing)

Since you are setting up Android Studio on your Mac:

1.  **Install Android Studio**: [Download here](https://developer.android.com/studio).
2.  **Install SDK Components**:
    *   Open Android Studio -> Settings -> Languages & Frameworks -> Android SDK.
    *   **SDK Platforms**: Ensure the latest Android version (e.g., Android 14/15) is checked.
    *   **SDK Tools**: Ensure "Android SDK Build-Tools", "Android Emulator", and "Android SDK Platform-Tools" are checked.
3.  **Create an Emulator**:
    *   Open "Device Manager" in Android Studio.
    *   Click "Create device".
    *   Choose a phone (e.g., Pixel 8).
    *   Select a system image (e.g., API 34 / Android 14).
    *   Finish and run the emulator.
4.  **Set Environment Variables**:
    Add the following to your shell configuration (`~/.zshrc` or `~/.bash_profile`):
    ```bash
    export ANDROID_HOME=$HOME/Library/Android/sdk
    export PATH=$PATH:$ANDROID_HOME/emulator
    export PATH=$PATH:$ANDROID_HOME/platform-tools
    ```
    Then run `source ~/.zshrc`.

## 2. Important: Firebase Configuration (`google-services.json`)

To ensure Push Notifications and other Firebase services work correctly on Android, you need to add the `google-services.json` file.

1.  Go to the [Firebase Console](https://console.firebase.google.com/).
2.  Open your project ("greenhaus-app").
3.  Click the gear icon (Project Settings).
4.  Scroll down to "Your apps".
5.  If there is no Android app, click "Add app" (Android icon).
    *   **Package Name**: `app.rork.greenlooployaltyorderingplatform` (Must match `app.json`).
    *   **App Nickname**: "GreenHaus Android".
6.  Download the `google-services.json` file.
7.  Place this file in the **root** of your project (same level as `app.json`).
8.  Update `app.json` to reference it:

```json
{
  "expo": {
    "android": {
      "googleServicesFile": "./google-services.json",
      ...
    }
  }
}
```

## 3. Production Build & Keystore

For the Google Play Store, you need a signed production build (AAB format). Expo (EAS) handles the keystore management securely for you.

### To build for production:

```bash
eas build --platform android --profile production
```

*   This command will ask you to generate a new keystore if one doesn't exist. **Say YES**.
*   It will upload the keystore to EAS servers so future builds are signed automatically.
*   The output will be an `.aab` (Android App Bundle) file, which is what Google Play requires.

## 4. Google Play Store Submission

1.  **Create a Google Play Console Account**:
    *   Go to [Google Play Console](https://play.google.com/console).
    *   Pay the one-time registration fee ($25).
2.  **Create App**:
    *   Click "Create app".
    *   **App Name**: GreenHaus
    *   **Language**: English (US)
    *   **App or Game**: App
    *   **Free or Paid**: Free
3.  **Upload Bundle**:
    *   Go to "Production" (or "Internal testing" for first test).
    *   "Create new release".
    *   Upload the `.aab` file generated by EAS.
4.  **Complete Store Listing**:
    *   Short description & Full description.
    *   Graphics (App Icon 512x512, Feature Graphic 1024x500, Phone Screenshots).
5.  **Privacy Policy**:
    *   You must provide a URL to your privacy policy.
6.  **App Content Questionnaire**:
    *   Answer questions about ads, content ratings, permissions, etc.
    *   Since we use Location, you will need to justify why (Store finding / Delivery compliance).

## 5. Troubleshooting: "Process system isn't responding" Error

If your Android emulator keeps showing "Process system isn't responding", try these solutions in order:

### Quick Fixes (Try First):

1. **Cold Boot the Emulator**:
   - Close the emulator completely
   - In Android Studio, go to **Device Manager**
   - Click the dropdown arrow next to your emulator
   - Select **"Cold Boot Now"** (this performs a clean restart)

2. **Restart the Emulator**:
   - Close the emulator window
   - Wait 10 seconds
   - Start it again from Device Manager

3. **Click "Wait"**:
   - Sometimes the system just needs a moment to catch up
   - Click "Wait" and give it 30-60 seconds

### If Quick Fixes Don't Work:

4. **Increase Emulator Resources**:
   - In Android Studio, go to **Device Manager**
   - Click the **pencil icon** (Edit) next to your emulator
   - Click **"Show Advanced Settings"**
   - Increase:
     - **RAM**: Set to at least 2048 MB (2 GB), ideally 4096 MB (4 GB) if you have 16+ GB system RAM
     - **VM heap**: 512 MB
     - **Internal Storage**: At least 2048 MB
   - Click **"Finish"** and restart the emulator

5. **Use a Lighter System Image**:
   - Delete your current emulator (Device Manager → dropdown → Delete)
   - Create a new one with:
     - **API Level 33 (Android 13)** instead of API 34/35 (newer versions can be slower)
     - **x86_64** architecture (faster than ARM on Mac)
     - Choose a device with less resolution (e.g., Pixel 5 instead of Pixel 8)

6. **Enable Hardware Acceleration**:
   - Make sure you have **Intel HAXM** or **Apple Hypervisor** enabled
   - On Mac, this is usually automatic, but check:
     ```bash
     # Check if virtualization is available
     sysctl -a | grep machdep.cpu.features | grep VMX
     ```

7. **Wipe Emulator Data** (Last Resort):
   - In Device Manager, click the dropdown next to your emulator
   - Select **"Wipe Data"**
   - This will delete all apps and data, but may fix persistent issues

### Recommended Emulator Settings for Mac:

- **Device**: Pixel 5 or Pixel 6
- **System Image**: API 33 (Android 13) with Google Play
- **RAM**: 4096 MB (if you have 16+ GB system RAM)
- **VM heap**: 512 MB
- **Graphics**: Automatic (or Hardware - GLES 2.0)
- **Multi-core CPU**: 2-4 cores (don't use all your CPU cores)

## 6. Local Testing

Once your emulator is running properly:

```bash
npm run android
# or
npx expo run:android
```

This will build the native Android app locally and install it on the emulator.

